<section class="bg-gray-50 dark:bg-dark-mode">
  <div class="flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0">
    <a href="#" class="flex items-center mb-6 text-2xl font-semibold text-gray-900 dark:text-white">
      <img class="w-16 h-16 mr-2" src="assets/icons/logo-dark.png" alt="logo">
      Remontada
    </a>
    <div class="w-full bg-white dark:bg-[#394151] rounded-lg shadow dark:border md:mt-0 sm:max-w-md xl:p-0 dark:bg-gray-800 dark:border-gray-700 ">
      <div class="p-6 space-y-4 md:space-y-6 sm:p-8 dark:text-white">
        <div (click)="signInWithProvider()" class="flex flex-row justify-center items-center space-x-3">
          <button class="px-4 py-2 border flex gap-2 border-slate-200 dark:border-slate-700 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 hover:text-slate-900 dark:hover:text-slate-300 hover:shadow transition duration-150 dark:border" >
            <img alt="google logo" class="w-6 h-6" loading="lazy" src="https://www.svgrepo.com/show/475656/google-color.svg">
            <span class="dark:text-white">Sign up with with Google</span>
          </button>
        </div>
        <div class="flex items-center justify-center space-x-2 dark:text-white">
          <span class="h-px w-44 bg-gray-200 dark:bg-white"></span>
          <span class="text-gray-300 font-normal">or</span>
          <span class="h-px w-44 bg-gray-200 dark:bg-white"></span>
        </div>
        <h1 class="text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl dark:text-white">
          Create an account
        </h1>
        <form (ngSubmit)="onRegister()" [formGroup]="registerForm" class="space-y-4 md:space-y-6" action="#">
          <!--Email field-->
          <div class="flex flex-col">
            <label for="registerEmail" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Your email</label>
            <div class="relative">
              <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                <svg class="w-4 h-4 text-gray-500 dark:text-black" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 16">
                  <path d="m10.036 8.278 9.258-7.79A1.979 1.979 0 0 0 18 0H2A1.987 1.987 0 0 0 .641.541l9.395 7.737Z"/>
                  <path d="M11.241 9.817c-.36.275-.801.425-1.255.427-.428 0-.845-.138-1.187-.395L0 2.6V14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2.5l-8.759 7.317Z"/>
                </svg>
              </div>
              <div class="flex">
                <input type="email" name="email" id="registerEmail" class="bg-gray-50 border border-gray-300 text-gray-900 text-lg rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray dark:focus:ring-blue-500 dark:focus:border-blue-500" formControlName="email"  placeholder="name@company.com">
                <button [class.bg-green-700]="registerForm.controls['email'].valid && registerForm.controls['email'].touched"
                        [class.bg-red-700]="registerForm.controls['email'].invalid && registerForm.controls['email'].touched"
                        data-tooltip-target="tooltip-email" data-tooltip-placement="right"
                        type="button"
                        class="rounded-full ms-4 focus:outline-none p-2.5">
                  <svg class="w-6 h-6 text-dark-gray dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9h2v5m-2 0h4M9.408 5.5h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <!--Password field-->
          <div class="flex flex-col">
            <label for="registerPassword" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Password</label>
            <div class="relative">
              <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                <svg class="w-6 h-6 text-gray-800 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 20">
                  <path d="M14 7h-1.5V4.5a4.5 4.5 0 1 0-9 0V7H2a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2Zm-5 8a1 1 0 1 1-2 0v-3a1 1 0 1 1 2 0v3Zm1.5-8h-5V4.5a2.5 2.5 0 1 1 5 0V7Z"/>
                </svg>
              </div>
              <div class="flex">
                <input type="password" name="password" formControlName="password" id="registerPassword" placeholder="••••••••" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray dark:focus:ring-blue-500 dark:focus:border-blue-500">
                <button [class.bg-green-700]="registerForm.controls['password'].valid && registerForm.controls['password'].touched"
                        [class.bg-red-700]="registerForm.controls['password'].invalid && registerForm.controls['password'].touched"
                        data-tooltip-target="tooltip-password" data-tooltip-placement="right"
                        type="button"
                        class="rounded-full ms-4 focus:outline-none p-2.5">
                  <svg class="w-6 h-6 text-dark-gray dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9h2v5m-2 0h4M9.408 5.5h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <!--Confrim password-->
          <div class="flex flex-col">
            <label for="registerConfirmPassword" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Confirm password</label>
            <div class="relative">
              <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                <svg class="w-4 h-4 text-gray-800 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 14">
                  <g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                    <path d="M10 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                    <path d="M10 13c4.97 0 9-2.686 9-6s-4.03-6-9-6-9 2.686-9 6 4.03 6 9 6Z"/>
                  </g>
                </svg>
              </div>
              <div class="flex">
                <input type="password" name="confirm-password" formControlName="confirmPassword" id="registerConfirmPassword" placeholder="••••••••" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray dark:focus:ring-blue-500 dark:focus:border-blue-500">
                <button [class.bg-green-700]="registerForm.controls['confirmPassword'].valid && !registerForm.errors?.['mismatchedPasswords'] && registerForm.controls['confirmPassword'].touched"
                        [class.bg-red-700]="registerForm.controls['confirmPassword'].invalid || registerForm.errors?.['mismatchedPasswords'] && registerForm.controls['confirmPassword'].touched"
                        data-tooltip-target="tooltip-confirm-password" data-tooltip-placement="right"
                        type="button"
                        class="rounded-full ms-4 focus:outline-none p-2.5">
                  <!-- Icon SVG -->
                  <svg class="w-6 h-6 text-gray-800 text-dark-gray dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9h2v5m-2 0h4M9.408 5.5h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                  </svg>
                </button>
              </div>
            </div>

          </div>
          <div class="flex items-start">
            <div class="flex items-center h-5">
              <input id="terms" aria-describedby="terms" type="checkbox" (change)="termsAcceptedChange()" class="w-4 h-4 border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-primary-300 dark:bg-gray-700 dark:border-gray-600 dark:focus:ring-primary-600 dark:ring-offset-gray-800" required>
            </div>
            <div class="ml-3 text-sm">
              <label for="terms" class="font-light text-gray-500 dark:text-white">I accept the <a (click)="openTCModal()" class="font-medium text-primary-600 hover:underline dark:text-primary-500">Terms and Conditions</a></label>
            </div>
          </div>
          <button [disabled]="loading || !termsAccepted"
                  [class.opacity-50]="loading || !termsAccepted"
                  class="w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"
                  type="submit">
            {{ loading ? 'Loading...' : 'Create your account' }}
          </button>
          <p class="text-sm font-light text-gray-500 dark:text-white">
            Already have an account? <a href="#" class="font-medium text-primary-600 hover:underline dark:text-primary-500">Login here</a>
          </p>
        </form>
      </div>
    </div>
  </div>
</section>

<!--Tooltips-->
<!-- Tooltip for email field-->
<div id="tooltip-email" role="tooltip" class="absolute z-10 inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-dark-gray rounded-lg shadow-sm opacity-0 tooltip dark:bg-dark-gray">
  <div *ngIf="registerForm.controls['email'].untouched">
    Enter your email address.
  </div>
  <!-- Dynamic Tooltip Content Based on Specific Error -->
  <div *ngIf="registerForm.controls['email'].invalid && registerForm.controls['email'].touched">
    <div *ngIf="registerForm.controls['email'].errors?.['required']">Email is required.</div>
    <div *ngIf="registerForm.controls['email'].errors?.['email']">Please enter a valid email.</div>
    <div *ngIf="registerForm.controls['email'].errors?.['minlength']">Email must be at least 5 characters long.</div>
    <div *ngIf="registerForm.controls['email'].errors?.['emailExists']">Email is already in use!</div>
  </div>
  <div *ngIf="registerForm.controls['email'].valid">Email is valid.</div>
  <div class="tooltip-arrow" data-popper-arrow></div>
</div>

<div id="tooltip-password" role="tooltip" class="absolute z-10 inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-dark-gray rounded-lg shadow-sm opacity-0 tooltip dark:bg-dark-gray">
  <div *ngIf="registerForm.controls['password'].untouched">Enter your password.</div>
  <!-- Dynamic Tooltip Content Based on Specific Error -->
  <div *ngIf="registerForm.controls['password'].invalid && registerForm.controls['password'].touched">
    <div *ngIf="registerForm.controls['password'].errors?.['required']">Password is required.</div>
    <div *ngIf="registerForm.controls['password'].errors?.['minlength']">Password must be at least 8 characters long.</div>
    <div *ngIf="registerForm.controls['password'].errors?.['pattern']">Password must contain at least 1 uppercase letter, 1 lowercase letter, and 1 number.</div>
  </div>
  <div *ngIf="registerForm.controls['password'].valid ">Password is valid.</div>
  <div class="tooltip-arrow" data-popper-arrow></div>
</div>

<!--Confirm password-->
<div id="tooltip-confirm-password" role="tooltip" class="absolute z-10 inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-dark-gray rounded-lg shadow-sm opacity-0 tooltip dark:bg-dark-gray">
  <div *ngIf="registerForm.controls['confirmPassword'].untouched">Enter your password again.</div>
  <!-- Dynamic Tooltip Content Based on Specific Error -->
  <div *ngIf="registerForm.controls['confirmPassword'].invalid && registerForm.controls['confirmPassword'].touched">
    <div *ngIf="registerForm.controls['confirmPassword'].errors?.['required']">Password confirmation is required.</div>
  </div>
  <div *ngIf="registerForm.errors?.['mismatchedPasswords'] && registerForm.controls['confirmPassword'].touched">Passwords do not match.</div>
  <div *ngIf="registerForm.controls['confirmPassword'].valid && !registerForm.errors?.['mismatchedPasswords'] && registerForm.controls['confirmPassword'].touched">Passwords match.</div>
  <div class="tooltip-arrow" data-popper-arrow></div>
</div>

<app-custom-alert [message]="alertMessage" [show]="showAlert"></app-custom-alert>
